{% extends 'sidebar.html' %}
{% load static %}

{% block content %}
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }

  .content-wrapper {
    padding: 20px;
    width: 100%;
    overflow-y: auto;
    max-height: 100vh;
    background-color: #f8f9fa;
  }

  .header-container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
  }

  .page-title {
    font-size: 24px;
    font-weight: 600;
    margin: 0;
    color: #333;
  }

  .action-buttons {
    display: flex;
    gap: 10px;
  }

  .btn-primary {
    background-color: #0d6efd;
    color: white;
    padding: 8px 16px;
    border-radius: 4px;
    text-decoration: none;
    display: flex;
    align-items: center;
    font-weight: 500;
    border: none;
    cursor: pointer;
  }

  .btn-outline {
    background-color: white;
    color: #333;
    padding: 8px 16px;
    border-radius: 4px;
    border: 1px solid #ddd;
    text-decoration: none;
    display: flex;
    align-items: center;
    font-weight: 500;
    cursor: pointer;
  }

  .btn-primary i, .btn-outline i {
    margin-right: 8px;
  }

  .card {
    background: white;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    padding: 20px;
    margin-bottom: 20px;
  }

  .card-header {
    margin-bottom: 20px;
  }

  .card-title {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 5px;
    color: #333;
  }

  .card-description {
    color: #666;
    margin: 0;
    font-size: 14px;
  }

  .search-container {
    margin-bottom: 20px;
  }

  .search-box {
    position: relative;
  }

  .search-input {
    width: 100%;
    padding: 10px 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    padding-left: 35px;
    font-size: 14px;
  }

  .search-icon {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #999;
  }

  .folders-container {
    display: flex;
    gap: 20px;
    margin-bottom: 30px;
  }

  .folder {
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    width: 100px;
    position: relative;
  }

  .folder-icon {
    width: 70px;
    height: 70px;
    background-color: #f5f5f5;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 8px;
    color: #666;
    font-size: 24px;
    position: relative;
  }

  .folder-name {
    font-size: 14px;
    color: #333;
    text-align: center;
  }

  .media-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 20px;
  }

  .media-item {
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    cursor: pointer;
    transition: transform 0.2s;
    position: relative;
  }

  .media-item:hover {
    transform: translateY(-3px);
  }

  .media-thumbnail {
    width: 100%;
    height: 120px;
    object-fit: cover;
  }

  .media-info {
    padding: 10px;
    background-color: white;
  }

  .media-name {
    font-size: 14px;
    color: #333;
    margin-bottom: 3px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .media-meta {
    font-size: 12px;
    color: #666;
  }

  /* Hover actions styles */
  .hover-actions {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
    opacity: 0;
    transition: opacity 0.3s;
    border-radius: 8px;
  }

  .folder:hover .hover-actions,
  .media-item:hover .hover-actions {
    opacity: 1;
  }

  .action-btn {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background-color: white;
    color: #333;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s;
    border: none;
  }

  .action-btn:hover {
    transform: scale(1.1);
  }

  .action-btn.view:hover {
    background-color: #e3f2fd;
    color: #0d6efd;
  }

  .action-btn.download:hover {
    background-color: #e8f5e9;
    color: #4caf50;
  }

  .action-btn.delete:hover {
    background-color: #ffebee;
    color: #f44336;
  }

  /* Modal styles */
  .modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
    z-index: 1000;
    align-items: center;
    justify-content: center;
  }

  .modal-content {
    background-color: white;
    border-radius: 8px;
    width: 500px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    position: relative;
  }

  .modal-header {
    padding: 15px 20px;
    border-bottom: 1px solid #eee;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .modal-title {
    font-size: 18px;
    font-weight: 600;
    color: #333;
  }

  .modal-close {
    background: none;
    border: none;
    font-size: 20px;
    cursor: pointer;
    color: #999;
    display: flex;
    margin-left: auto;
    margin-right: 5px;
  }

  .modal-body {
    padding: 20px;
  }

  .upload-area {
    border: 2px dashed #ddd;
    border-radius: 8px;
    padding: 40px 20px;
    margin-bottom: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  .upload-icon {
    font-size: 40px;
    color: #999;
    margin-bottom: 10px;
  }

  .upload-text {
    font-size: 16px;
    color: #333;
    margin-bottom: 5px;
  }

  .upload-hint {
    font-size: 14px;
    color: #666;
    margin-bottom: 15px;
  }

  .upload-formats {
    font-size: 12px;
    color: #999;
    margin-top: 15px;
  }

  .modal-footer {
    padding: 15px 20px;
    border-top: 1px solid #eee;
    display: flex;
    justify-content: flex-end;
    gap: 10px;
  }

  .btn-cancel {
    padding: 8px 16px;
    background-color: white;
    color: #333;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
    cursor: pointer;
  }

  .btn-upload, .btn-confirm {
    padding: 8px 16px;
    background-color: #0d6efd;
    color: white;
    border: none;
    border-radius: 4px;
    font-size: 14px;
    cursor: pointer;
  }

  .btn-delete {
    padding: 8px 16px;
    background-color: #f44336;
    color: white;
    border: none;
    border-radius: 4px;
    font-size: 14px;
    cursor: pointer;
  }

  /* Form styles for create folder modal */
  .form-group {
    margin-bottom: 15px;
  }

  .form-label {
    display: block;
    margin-bottom: 5px;
    font-weight: 500;
    color: #333;
    font-size: 14px;
  }

  .form-input {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
  }

  .form-select {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23333' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 10px center;
  }

  .form-textarea {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
    resize: vertical;
    min-height: 80px;
  }

  .form-hint {
    font-size: 12px;
    color: #666;
    margin-top: 5px;
  }

  .form-checkbox {
    display: flex;
    align-items: center;
    margin-top: 15px;
  }

  .form-checkbox input {
    margin-right: 8px;
  }

  .form-checkbox label {
    font-size: 14px;
    color: #333;
  }

  /* Notification styles */
  .notification-modal .modal-content {
    width: 350px;
  }

  .notification-body {
    padding: 30px 20px;
    text-align: center;
  }

  .notification-icon {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    margin: 0 auto 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 30px;
  }

  .notification-icon.success {
    background-color: #e8f5e9;
    color: #4caf50;
  }

  .notification-icon.warning {
    background-color: #fff8e1;
    color: #ff9800;
  }

  .notification-title {
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 10px;
  }

  .notification-title.success {
    color: #4caf50;
  }

  .notification-title.warning {
    color: #ff9800;
  }

  .notification-message {
    font-size: 14px;
    color: #666;
    margin-bottom: 20px;
  }

  .warning-box {
    background-color: #fff8e1;
    border-radius: 4px;
    padding: 10px;
    margin: 15px 0;
    text-align: left;
    border-left: 4px solid #ff9800;
  }

  .warning-text {
    color: #e65100;
    font-size: 14px;
    margin: 0;
  }

  /* Preview modal styles */
  .preview-modal .modal-content {
    width: 80%;
    max-width: 800px;
  }

  .preview-image {
    width: 100%;
    max-height: 70vh;
    object-fit: contain;
  }

  .preview-details {
    padding: 15px;
    border-top: 1px solid #eee;
  }

  .preview-name {
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 5px;
  }

  .preview-meta {
    display: flex;
    gap: 20px;
    font-size: 14px;
    color: #666;
  }

  .preview-meta-item {
    display: flex;
    align-items: center;
  }

  .preview-meta-item i {
    margin-right: 5px;
  }
</style>

<div class="content-wrapper">
  <div class="header-container">
    <h1 class="page-title">Quản lý media</h1>
    <div class="action-buttons">
      <button class="btn-primary" onclick="showUploadModal()">
        <i class="fas fa-upload"></i> Tải lên
      </button>
      <button class="btn-outline" onclick="showCreateFolderModal()">
        <i class="fas fa-plus"></i> Tạo thư mục
      </button>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <h2 class="card-title">Thư viện media</h2>
      <p class="card-description">Quản lý tất cả hình ảnh và tệp tin trong hệ thống của bạn</p>
    </div>

    <div class="search-container">
      <div class="search-box">
        <input type="text" placeholder="Tìm kiếm media..." class="search-input">
        <i class="fas fa-search search-icon"></i>
      </div>
    </div>

    <div class="folders-container">
      <div class="folder" data-id="1" data-name="Hình ảnh">
        <div class="folder-icon">
          <i class="fas fa-folder"></i>
        </div>
        <div class="folder-name">Hình ảnh</div>
        <div class="hover-actions">
          <button class="action-btn view" onclick="viewFolder(1, 'Hình ảnh')" title="Xem">
            <i class="fas fa-eye"></i>
          </button>
          <button class="action-btn download" onclick="downloadFolder(1, 'Hình ảnh')" title="Tải xuống">
            <i class="fas fa-download"></i>
          </button>
          <button class="action-btn delete" onclick="confirmDeleteFolder(1, 'Hình ảnh')" title="Xóa">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>
      <div class="folder" data-id="2" data-name="Tài liệu">
        <div class="folder-icon">
          <i class="fas fa-folder"></i>
        </div>
        <div class="folder-name">Tài liệu</div>
        <div class="hover-actions">
          <button class="action-btn view" onclick="viewFolder(2, 'Tài liệu')" title="Xem">
            <i class="fas fa-eye"></i>
          </button>
          <button class="action-btn download" onclick="downloadFolder(2, 'Tài liệu')" title="Tải xuống">
            <i class="fas fa-download"></i>
          </button>
          <button class="action-btn delete" onclick="confirmDeleteFolder(2, 'Tài liệu')" title="Xóa">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>
      <div class="folder" data-id="3" data-name="Videos">
        <div class="folder-icon">
          <i class="fas fa-folder"></i>
        </div>
        <div class="folder-name">Videos</div>
        <div class="hover-actions">
          <button class="action-btn view" onclick="viewFolder(3, 'Videos')" title="Xem">
            <i class="fas fa-eye"></i>
          </button>
          <button class="action-btn download" onclick="downloadFolder(3, 'Videos')" title="Tải xuống">
            <i class="fas fa-download"></i>
          </button>
          <button class="action-btn delete" onclick="confirmDeleteFolder(3, 'Videos')" title="Xóa">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>
    </div>

    <div class="media-grid">
      <div class="media-item" data-id="1" data-name="marketing-plan.jpg">
        <img src="{% static 'images/img_1.png' %}" alt="Marketing" class="media-thumbnail">
        <div class="media-info">
          <div class="media-name">marketing-plan.jpg</div>
          <div class="media-meta">JPG • 250KB</div>
        </div>
        <div class="hover-actions">
          <button class="action-btn view" onclick="previewMedia(1, 'marketing-plan.jpg')" title="Xem">
            <i class="fas fa-eye"></i>
          </button>
          <button class="action-btn download" onclick="downloadMedia(1, 'marketing-plan.jpg')" title="Tải xuống">
            <i class="fas fa-download"></i>
          </button>
          <button class="action-btn delete" onclick="confirmDeleteMedia(1, 'marketing-plan.jpg')" title="Xóa">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>
      <div class="media-item" data-id="2" data-name="marketing-strategy.jpg">
        <img src="{% static 'images/img_1.png' %}" alt="Marketing" class="media-thumbnail">
        <div class="media-info">
          <div class="media-name">marketing-strategy.jpg</div>
          <div class="media-meta">JPG • 180KB</div>
        </div>
        <div class="hover-actions">
          <button class="action-btn view" onclick="previewMedia(2, 'marketing-strategy.jpg')" title="Xem">
            <i class="fas fa-eye"></i>
          </button>
          <button class="action-btn download" onclick="downloadMedia(2, 'marketing-strategy.jpg')" title="Tải xuống">
            <i class="fas fa-download"></i>
          </button>
          <button class="action-btn delete" onclick="confirmDeleteMedia(2, 'marketing-strategy.jpg')" title="Xóa">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>
      <div class="media-item" data-id="3" data-name="office-building.jpg">
        <img src="{% static 'images/img_1.png' %}" alt="Building" class="media-thumbnail">
        <div class="media-info">
          <div class="media-name">office-building.jpg</div>
          <div class="media-meta">JPG • 320KB</div>
        </div>
        <div class="hover-actions">
          <button class="action-btn view" onclick="previewMedia(3, 'office-building.jpg')" title="Xem">
            <i class="fas fa-eye"></i>
          </button>
          <button class="action-btn download" onclick="downloadMedia(3, 'office-building.jpg')" title="Tải xuống">
            <i class="fas fa-download"></i>
          </button>
          <button class="action-btn delete" onclick="confirmDeleteMedia(3, 'office-building.jpg')" title="Xóa">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>
      <div class="media-item" data-id="4" data-name="modern-office.jpg">
        <img src="{% static 'images/img_1.png' %}" alt="Office" class="media-thumbnail">
        <div class="media-info">
          <div class="media-name">modern-office.jpg</div>
          <div class="media-meta">JPG • 290KB</div>
        </div>
        <div class="hover-actions">
          <button class="action-btn view" onclick="previewMedia(4, 'modern-office.jpg')" title="Xem">
            <i class="fas fa-eye"></i>
          </button>
          <button class="action-btn download" onclick="downloadMedia(4, 'modern-office.jpg')" title="Tải xuống">
            <i class="fas fa-download"></i>
          </button>
          <button class="action-btn delete" onclick="confirmDeleteMedia(4, 'modern-office.jpg')" title="Xóa">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>
      <div class="media-item" data-id="5" data-name="team-meeting.jpg">
        <img src="{% static 'images/img_1.png' %}" alt="Meeting" class="media-thumbnail">
        <div class="media-info">
          <div class="media-name">team-meeting.jpg</div>
          <div class="media-meta">JPG • 210KB</div>
        </div>
        <div class="hover-actions">
          <button class="action-btn view" onclick="previewMedia(5, 'team-meeting.jpg')" title="Xem">
            <i class="fas fa-eye"></i>
          </button>
          <button class="action-btn download" onclick="downloadMedia(5, 'team-meeting.jpg')" title="Tải xuống">
            <i class="fas fa-download"></i>
          </button>
          <button class="action-btn delete" onclick="confirmDeleteMedia(5, 'team-meeting.jpg')" title="Xóa">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>
      <div class="media-item" data-id="6" data-name="business-chart.jpg">
        <img src="{% static 'images/img_1.png' %}" alt="Business" class="media-thumbnail">
        <div class="media-info">
          <div class="media-name">business-chart.jpg</div>
          <div class="media-meta">JPG • 175KB</div>
        </div>
        <div class="hover-actions">
          <button class="action-btn view" onclick="previewMedia(6, 'business-chart.jpg')" title="Xem">
            <i class="fas fa-eye"></i>
          </button>
          <button class="action-btn download" onclick="downloadMedia(6, 'business-chart.jpg')" title="Tải xuống">
            <i class="fas fa-download"></i>
          </button>
          <button class="action-btn delete" onclick="confirmDeleteMedia(6, 'business-chart.jpg')" title="Xóa">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal tải lên tệp tin -->
<div id="uploadModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">Tải lên tệp tin</h3>
      <button class="modal-close" onclick="closeUploadModal()">&times;</button>
    </div>
    <div class="modal-body">
      <div class="upload-area" id="dropArea">
        <div class="upload-icon">
          <i class="fas fa-cloud-upload-alt"></i>
        </div>
        <div class="upload-text">Kéo và thả tệp tin vào đây</div>
        <div class="upload-hint">hoặc nhấp vào nút bên dưới để chọn tệp tin từ máy tính của bạn</div>
        <button class="btn-primary" id="selectFileBtn">
          <i class="fas fa-file"></i> Chọn tệp tin
        </button>
        <input type="file" id="fileInput" style="display: none;" multiple>
        <div class="upload-formats">
          Hỗ trợ: JPG, PNG, GIF, SVG, MP4, PDF (Tối đa 10MB)
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-cancel" onclick="closeUploadModal()">Hủy</button>
      <button class="btn-upload">Tải lên</button>
    </div>
  </div>
</div>

<!-- Modal tạo thư mục mới -->
<div id="createFolderModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">Tạo thư mục mới</h3>
      <button class="modal-close" onclick="closeCreateFolderModal()">&times;</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label for="folderName" class="form-label">Tên thư mục</label>
        <input type="text" id="folderName" class="form-input" placeholder="Nhập tên thư mục">
      </div>
      <div class="form-group">
        <label for="parentFolder" class="form-label">Thư mục cha</label>
        <select id="parentFolder" class="form-select">
          <option value="">Thư mục gốc</option>
          <option value="1">Hình ảnh</option>
          <option value="2">Tài liệu</option>
          <option value="3">Videos</option>
        </select>
        <div class="form-hint">
          Chọn thư mục cha để tổ chức media của bạn. Để trống để tạo thư mục ở thư mục gốc.
        </div>
      </div>
      <div class="form-group">
        <label for="folderDescription" class="form-label">Mô tả (tùy chọn)</label>
        <textarea id="folderDescription" class="form-textarea" placeholder="Mô tả ngắn về thư mục này"></textarea>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="privateFolder">
        <label for="privateFolder">Thư mục riêng tư</label>
      </div>
      <div class="form-hint">
        Nếu được chọn, chỉ người dùng có quyền mới có thể truy cập thư mục này.
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-cancel" onclick="closeCreateFolderModal()">Hủy</button>
      <button class="btn-upload" onclick="createFolder()">Tạo thư mục</button>
    </div>
  </div>
</div>

<!-- Modal xác nhận xóa thư mục -->
<div id="deleteFolderModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">Xác nhận xóa</h3>
      <button class="modal-close" onclick="closeDeleteFolderModal()">&times;</button>
    </div>
    <div class="modal-body">
      <div class="notification-icon warning">
        <i class="fas fa-exclamation-triangle"></i>
      </div>
      <div class="notification-title warning">Bạn có chắc chắn muốn xóa không?</div>
      <div class="notification-message">Thư mục "<span id="folderNameToDelete"></span>" sẽ bị xóa vĩnh viễn.</div>
      <div class="warning-box">
        <p class="warning-text">
          <i class="fas fa-exclamation-triangle"></i>
          Cảnh báo: Hành động này không thể hoàn tác và có thể dẫn đến mất dữ liệu.
        </p>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-cancel" onclick="closeDeleteFolderModal()">Hủy</button>
      <button class="btn-delete" onclick="deleteFolder()">Xóa</button>
    </div>
  </div>
</div>

<!-- Modal xác nhận xóa media -->
<div id="deleteMediaModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">Xác nhận xóa</h3>
      <button class="modal-close" onclick="closeDeleteMediaModal()">&times;</button>
    </div>
    <div class="modal-body">
      <div class="notification-icon warning">
        <i class="fas fa-exclamation-triangle"></i>
      </div>
      <div class="notification-title warning">Bạn có chắc chắn muốn xóa không?</div>
      <div class="notification-message">Tệp tin "<span id="mediaNameToDelete"></span>" sẽ bị xóa vĩnh viễn.</div>
      <div class="warning-box">
        <p class="warning-text">
          <i class="fas fa-exclamation-triangle"></i>
          Cảnh báo: Hành động này không thể hoàn tác và có thể dẫn đến mất dữ liệu.
        </p>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-cancel" onclick="closeDeleteMediaModal()">Hủy</button>
      <button class="btn-delete" onclick="deleteMedia()">Xóa</button>
    </div>
  </div>
</div>

<!-- Modal thông báo thành công -->
<div id="successModal" class="modal notification-modal">
  <div class="modal-content">
    <button class="modal-close" onclick="closeSuccessModal()">&times;</button>
    <div class="notification-body">
      <div class="notification-icon success">
        <i class="fas fa-check"></i>
      </div>
      <div class="notification-title success">Thành công!</div>
      <p id="successMessage" class="notification-message">Thao tác đã được thực hiện thành công.</p>
      <button class="btn-confirm" onclick="closeSuccessModal()">Đóng</button>
    </div>
  </div>
</div>

<!-- Modal xem trước media -->
<div id="previewModal" class="modal preview-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">Xem trước</h3>
      <button class="modal-close" onclick="closePreviewModal()">&times;</button>
    </div>
    <div class="modal-body">
      <img id="previewImage" src="/placeholder.svg" alt="Preview" class="preview-image">
      <div class="preview-details">
        <div id="previewName" class="preview-name"></div>
        <div class="preview-meta">
          <div class="preview-meta-item">
            <i class="fas fa-file"></i>
            <span id="previewType">JPG</span>
          </div>
          <div class="preview-meta-item">
            <i class="fas fa-weight-hanging"></i>
            <span id="previewSize">250KB</span>
          </div>
          <div class="preview-meta-item">
            <i class="fas fa-calendar-alt"></i>
            <span id="previewDate">15/05/2023</span>
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-cancel" onclick="closePreviewModal()">Đóng</button>
      <button class="btn-primary" onclick="downloadCurrentMedia()">
        <i class="fas fa-download"></i> Tải xuống
      </button>
    </div>
  </div>
</div>

<script>
  // Biến lưu trữ ID và tên của thư mục/media đang được thao tác
  let currentFolderId = null;
  let currentFolderName = null;
  let currentMediaId = null;
  let currentMediaName = null;

  // Hiển thị modal tải lên
  function showUploadModal() {
    document.getElementById('uploadModal').style.display = 'flex';
  }

  // Đóng modal tải lên
  function closeUploadModal() {
    document.getElementById('uploadModal').style.display = 'none';
  }

  // Hiển thị modal tạo thư mục
  function showCreateFolderModal() {
    document.getElementById('createFolderModal').style.display = 'flex';
  }

  // Đóng modal tạo thư mục
  function closeCreateFolderModal() {
    document.getElementById('createFolderModal').style.display = 'none';
  }

  // Tạo thư mục mới
  function createFolder() {
    // Ở đây sẽ gọi API để tạo thư mục
    // Sau khi tạo thành công, hiển thị thông báo
    closeCreateFolderModal();
    document.getElementById('successMessage').textContent = 'Tạo thư mục thành công!';
    document.getElementById('successModal').style.display = 'flex';
  }

  // Xem thư mục
  function viewFolder(id, name) {
    // Ở đây sẽ chuyển đến trang xem thư mục
    // Hoặc hiển thị nội dung thư mục
    document.getElementById('successMessage').textContent = `Đã mở thư mục "${name}"`;
    document.getElementById('successModal').style.display = 'flex';
  }

  // Tải xuống thư mục
  function downloadFolder(id, name) {
    // Ở đây sẽ gọi API để tải xuống thư mục
    document.getElementById('successMessage').textContent = `Đang tải xuống thư mục "${name}"`;
    document.getElementById('successModal').style.display = 'flex';
  }

  // Xác nhận xóa thư mục
  function confirmDeleteFolder(id, name) {
    currentFolderId = id;
    currentFolderName = name;
    document.getElementById('folderNameToDelete').textContent = name;
    document.getElementById('deleteFolderModal').style.display = 'flex';
  }

  // Đóng modal xác nhận xóa thư mục
  function closeDeleteFolderModal() {
    document.getElementById('deleteFolderModal').style.display = 'none';
  }

  // Xóa thư mục
  function deleteFolder() {
    // Ở đây sẽ gọi API để xóa thư mục
    closeDeleteFolderModal();
    document.getElementById('successMessage').textContent = `Đã xóa thư mục "${currentFolderName}"`;
    document.getElementById('successModal').style.display = 'flex';
  }

  // Xem trước media
  function previewMedia(id, name) {
    currentMediaId = id;
    currentMediaName = name;

    // Thiết lập thông tin cho modal xem trước
    document.getElementById('previewImage').src = "{% static 'images/img_1.png' %}";
    document.getElementById('previewName').textContent = name;
    document.getElementById('previewType').textContent = 'JPG';
    document.getElementById('previewSize').textContent = '250KB';
    document.getElementById('previewDate').textContent = '15/05/2023';

    document.getElementById('previewModal').style.display = 'flex';
  }

  // Đóng modal xem trước
  function closePreviewModal() {
    document.getElementById('previewModal').style.display = 'none';
  }

  // Tải xuống media hiện tại đang xem
  function downloadCurrentMedia() {
    closePreviewModal();
    downloadMedia(currentMediaId, currentMediaName);
  }

  // Tải xuống media
  function downloadMedia(id, name) {
    // Ở đây sẽ gọi API để tải xuống media
    document.getElementById('successMessage').textContent = `Đang tải xuống tệp tin "${name}"`;
    document.getElementById('successModal').style.display = 'flex';
  }

  // Xác nhận xóa media
  function confirmDeleteMedia(id, name) {
    currentMediaId = id;
    currentMediaName = name;
    document.getElementById('mediaNameToDelete').textContent = name;
    document.getElementById('deleteMediaModal').style.display = 'flex';
  }

  // Đóng modal xác nhận xóa media
  function closeDeleteMediaModal() {
    document.getElementById('deleteMediaModal').style.display = 'none';
  }

  // Xóa media
  function deleteMedia() {
    // Ở đây sẽ gọi API để xóa media
    closeDeleteMediaModal();
    document.getElementById('successMessage').textContent = `Đã xóa tệp tin "${currentMediaName}"`;
    document.getElementById('successModal').style.display = 'flex';
  }

  // Đóng modal thông báo thành công
  function closeSuccessModal() {
    document.getElementById('successModal').style.display = 'none';
  }

  document.addEventListener('DOMContentLoaded', function() {
    // Xử lý chọn file
    const fileInput = document.getElementById('fileInput');
    const selectFileBtn = document.getElementById('selectFileBtn');

    selectFileBtn.addEventListener('click', function() {
      fileInput.click();
    });

    // Xử lý kéo thả file
    const dropArea = document.getElementById('dropArea');

    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
      dropArea.addEventListener(eventName, preventDefaults, false);
    });

    function preventDefaults(e) {
      e.preventDefault();
      e.stopPropagation();
    }

    ['dragenter', 'dragover'].forEach(eventName => {
      dropArea.addEventListener(eventName, highlight, false);
    });

    ['dragleave', 'drop'].forEach(eventName => {
      dropArea.addEventListener(eventName, unhighlight, false);
    });

    function highlight() {
      dropArea.style.borderColor = '#0d6efd';
      dropArea.style.backgroundColor = '#f0f7ff';
    }

    function unhighlight() {
      dropArea.style.borderColor = '#ddd';
      dropArea.style.backgroundColor = 'transparent';
    }

    dropArea.addEventListener('drop', handleDrop, false);

    function handleDrop(e) {
      const dt = e.dataTransfer;
      const files = dt.files;

      // Ở đây bạn có thể xử lý files
      console.log(files);
    }
  });
</script>
{% endblock %}